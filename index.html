<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Triangle Rust WASM</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <canvas width="800" height="600" id="my_canvas"></canvas>
    <script>
      var gl;
      var canvas;

      function setupCanvas() {
        console.log("Setting up the canvas...");
        let canvas = document.getElementById("my_canvas");
        gl = canvas.getContext("webgl");
        if (!gl) {
          console.log("Failed to get a WebGL context for the canvas!");
          return;
        }
      }

      function clearToBlue() {
        gl.clearColor(0.1, 0.1, 0.9, 1.0);
        gl.clear(gl.COLOR_BUFFER_BIT);
      }

      var importObject = {
        env: {
          setupCanvas: setupCanvas,
          clearToBlue: clearToBlue,
        }
      };

      const mod_path = "./target/wasm32-unknown-unknown/release/triangle_wasm_rust.wasm";
      WebAssembly.instantiateStreaming(fetch(mod_path), importObject)
      .then(results => {
        results.instance.exports.start();
      });
    </script>
  </body>
</html>
